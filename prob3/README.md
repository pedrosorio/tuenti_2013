For each script, parse it, identifying the (integer) position of fixed (ordered) scenes and the conditions for the "floating" ones (smaller or larger than an integer representing an "ordered scene").

Run the check function on each scene, which takes the position and conditions for the scene and returns -1 if the position and conditions conflict, the integer position if the scene is possible and has a defined position in the story and the possible interval if the scene has no fixed position.

Finally, run the overlaps function with all the points and intervals, returning invalid if there are more than two intervals before/after the first/last fixed point in the story (since this contradicts the condition of the problem statement that the starting point and ending point must be well defined). If any interval overlaps with another interval or a point, returns valid (i.e. scenes can have different orders) and the scene order if they don't overlap. 